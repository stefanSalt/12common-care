# admin-ui 后台管理 UI 落地计划（2026-01-25）

## 目标

- 在不改动后端接口（除非发现缺口并经你确认）的前提下，补齐后台管理端 UI：
  - 用户 / 角色 / 权限（CRUD + 关联分配）
  - 文件（上传/列表/下载/删除）
  - 通知（列表/已读/公告发布 + WebSocket 实时接收）
- 坚持最小修改：复用现有 Vue3 + Router + Pinia + Element Plus + Axios 工程骨架。
- 可验证：`npm run build` 通过；提供手工联调 checklist。

## 约束（No Gold-Plating）

- 不做主题/皮肤/复杂组件抽象；页面以“能用、清晰”为主。
- 不做超出 API 规格的功能（例如：重置密码、修改文件可见性、权限分组/树等）。
- 权限控制以“后端 403 + 前端 v-permission 隐藏按钮”为主（路由级权限仅做最小必要）。

## 路由与布局约定

- 前台占位：`/`（已存在 FrontendLayout，占位不扩展业务）
- 后台管理：`/admin/*`
  - `/admin`（Home）
  - `/admin/users`
  - `/admin/roles`
  - `/admin/permissions`
  - `/admin/files`
  - `/admin/notifications`

## 任务清单（UI → 联调）

- [ ] 路由与布局
  - [ ] 扩展 `frontend/src/router/index.ts`：补齐 `/admin/*` 子路由
  - [ ] 扩展 `frontend/src/layouts/AdminLayout.vue`：加入最小菜单/导航（按权限显示）
- [ ] API 封装（对齐 `.kiro/specs/admin-base/api-spec.md`）
  - [ ] 新增 `frontend/src/api/user.ts`
  - [ ] 新增 `frontend/src/api/role.ts`
  - [ ] 新增 `frontend/src/api/permission.ts`
  - [ ] 新增 `frontend/src/api/file.ts`
  - [ ] 新增 `frontend/src/api/notification.ts`
- [ ] 用户管理页（`/admin/users`）
  - [ ] 分页列表
  - [ ] 创建 / 编辑 / 删除
  - [ ] 分配角色（覆盖式保存）
- [ ] 角色管理页（`/admin/roles`）
  - [ ] 列表
  - [ ] 创建 / 编辑 / 删除
  - [ ] 分配权限（覆盖式保存）
- [ ] 权限管理页（`/admin/permissions`）
  - [ ] 列表 + 创建 / 编辑 / 删除
- [ ] 文件管理页（`/admin/files`）
  - [ ] 我的文件分页列表
  - [ ] 上传（可选 visibility，默认 PRIVATE）
  - [ ] 下载 / 删除
- [ ] 通知页（`/admin/notifications`）
  - [ ] 分页列表 + 标记已读
  - [ ] 发布公告（按钮受 `v-permission="'notification:announce'"` 控制）
  - [ ] WebSocket：连接 `/ws/notification?token=...`，接收 `init` + `notification`
- [ ] 验证闭环
  - [ ] `npm run build` 通过
  - [ ] 手工联调 checklist：登录 → RBAC → 文件 → 通知/WS

## 需要你确认的问题（开始编码前必须确认）

1) 菜单可见策略：
   - A. 仅显示“当前用户有权限”的菜单（推荐）
   - B. 菜单全显示，点击后由后端 403 拦截（最省事但体验差）

2) 用户创建表单字段范围：
   - A. username/password/nickname/status（推荐）
   - B. 再加 email/phone（可选）

3) 角色/权限分配交互：
   - A. `el-select multiple` 多选下拉（推荐，开发最快）
   - B. 穿梭框（更适合大量数据，但实现稍多）

4) WebSocket 建立时机：
   - A. 仅在进入 `/admin` 后建立连接（推荐）
   - B. 登录成功即建立（即使在前台占位页）

已确认（2026-01-25）：
- 1A 2A 3A 4B
